<div class="container mx-auto p-4 mt-6">
  <nav aria-label="breadcrumb" class="mb-4">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><%= link_to 'Products', products_path %></li>
      <li class="breadcrumb-item"><%= link_to @category.name, category_path(@category) %></li>
      <li class="breadcrumb-item active" aria-current="page"><%= @product.name %></li>
    </ol>
  </nav>
  <div class="flex flex-col md:flex-row justify-center items-center space-y-6 md:space-y-0 md:space-x-6">
    <div class="md:w-1/3">
      <div class="image-container mb-4">
        <% if @product.image.attached? %>
          <%= image_tag @product.large_image, class: "object-cover rounded-lg" %>
        <% else %>
          <div class="image-placeholder-large"></div>
        <% end %>
      </div>
    </div>
    <div class="md:w-1/3">
      <h1 class="text-3xl font-bold mb-2 mt-14"><%= @product.name %></h1>
      <p class="text-gray-500 text-sm mb-4">Category: 
        <% @product.categories.each do |category| %>
          <%= link_to category.name, category_path(category), class: "text-blue-500 hover:underline" %>
          <%= "," unless category == @product.categories.last %>
        <% end %>
      </p>
      <div class="text-2xl font-semibold mb-4 <%= @product.on_sale? ? 'text-red-500' : 'text-black' %>">
        $<%= number_with_precision(@product.discounted_price > 0 ? @product.discounted_price : @product.price, precision: 2) %>
        <% if @product.on_sale? && @product.discounted_price > 0 %>
          <span class="line-through text-gray-500 text-xl">$<%= number_with_precision(@product.price, precision: 2) %></span>
        <% end %>
      </div>
      <div class="mb-4">
        <%= form_with url: add_to_cart_product_path(@product), method: :post, local: true do |f| %>
              <%= number_field_tag :quantity, 1, min: 1, class: "w-16 h-10 p-2 border rounded-lg mb-2" %>
              <%= f.submit 'Add to Cart', class: "bg-red-500 text-white px-6 py-2 rounded-lg cursor-pointer" %>
            <% end %>
      </div>
      <div class="border-t pt-4">
        <h2 class="text-xl font-bold mb-2">Product Description</h2>
        <p class="text-gray-700"><%= @product.description %></p>
      </div>
      <p class="text-sm text-gray-500 mt-2">
        Stock: <span class="<%= @product.stock_level[:color] %>"><%= @product.stock_level[:level] %></span>
      </p>
    </div>
  </div>
</div>
